<!DOCTYPE HTML>
<html>
<head>
	<title>Data -- DAC IOT SIUC Testing</title>
	<style type="text/css">
	.form_group {
		display: block;
		padding-bottom: .4em
	}
	label[for="values"] {
		display: block
	}
	textarea {
		height: 300px
	}
	</style>
</head>

<body>
	<canvas id="myChart" style="height: 400px; width: 100%;"></canvas>
	<p>Add data points manually below.</p>
	<form id="addData">
		<div class="form_group"><label for="time">Time: </label><input type="text" name="time" id="time"></div>
		<div class="form_group"><label for="people">Number of people: </label><input type="text" name="people" id="people"></div>
		<div class="form_group"><input type="submit" value="Add"></div>
	</form>
	<label for="values">Data: </label><textarea id="values"></textarea>

	<script src="chart.js"></script>
	<script type="text/javascript">
		var ctx = document.getElementById("myChart").getContext("2d");

		var scatterChart = new Chart(ctx, {
			type: 'line',
			data: {
				datasets: [{
					label: 'Number of people vs Time',
					fill: true,
					backgroundColor: 'rgba(255,0,0,.8)',
					borderColor: 'rgba(0,0,0,1)',
					data: [{
						x: 0,
						y: 0
					}]
				}]
			},
			options: {
				tooltips: {
					callbacks: {
						label: function(tooltipItem, data) {
								return 'Number of people: ' + tooltipItem.yLabel;
						},
						title: function(tooltipItem, data) {
						   return 'Time: ' + tooltipItem[0].xLabel;
						}
					}
				},
				scales: {
					xAxes: [{
						type: 'linear',
						position: 'bottom',
						ticks: {
							max: numTimes,
							min: 0
						},
						scaleLabel: {
							display: true,
							labelString: 'Time'
						}
					}],
					yAxes: [{
						ticks: {
							min: 0
						},
						scaleLabel: {
							display: true,
							labelString: 'Number of people'
						}
					}]
				}
			}
		});
		
		var numTimes = 200;
		var dataSet = scatterChart.data.datasets[0];
		var textArea = document.getElementById('values');
		
		document.getElementById("addData").addEventListener("submit", function(e) {
			e.preventDefault();
			appendData(document.getElementById('time').value, document.getElementById('people').value);
		});
		
		function appendData(datax,datay) {
				scatterChart.data.datasets[0].data.push({x:datax,y:datay});
				scatterChart.update();
				updateTextArea();
		}
		function updateTextArea() {
			textArea.innerHTML = "";
			for(var i=0; i < dataSet.data.length; i++ ) {
				textArea.innerHTML += dataSet.data[i].x + "," + dataSet.data[i].y + "\n";
			}
		}
	</script>
</body>
</html>